const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./C9jFe4fS.js","./B-knSOA7.js","./entry.C3baweD0.css","./C5zWpSVJ.js"])))=>i.map(i=>d[i]);
import{a9 as k,ab as F,c as P}from"./B-knSOA7.js";import{t as q}from"./C5zWpSVJ.js";const I=(e,s)=>{const t=e._conditions;return t.length>0?`(${t.join(` ${s} `)})`:""},N=e=>{const s=[],t={_conditions:s,where(n,i,r){let o;switch(i.toUpperCase()){case"IN":case"NOT IN":if(Array.isArray(r)){const c=r.map(u=>v(u)).join(", ");o=`"${String(n)}" ${i.toUpperCase()} (${c})`}else throw new TypeError(`Value for ${i} must be an array`);break;case"BETWEEN":case"NOT BETWEEN":if(Array.isArray(r)&&r.length===2)o=`"${String(n)}" ${i.toUpperCase()} ${v(r[0])} AND ${v(r[1])}`;else throw new Error(`Value for ${i} must be an array with two elements`);break;case"IS NULL":case"IS NOT NULL":o=`"${String(n)}" ${i.toUpperCase()}`;break;case"LIKE":case"NOT LIKE":o=`"${String(n)}" ${i.toUpperCase()} ${v(r)}`;break;default:o=`"${String(n)}" ${i} ${v(typeof r=="boolean"?Number(r):r)}`}return s.push(`${o}`),t},andWhere(n){const i=n(N());return s.push(I(i,"AND")),t},orWhere(n){const i=n(N());return s.push(I(i,"OR")),t}};return t},M=(e,s)=>{const t={conditions:[],selectedFields:[],offset:0,limit:0,orderBy:[],count:{field:"",distinct:!1}},n={__params:t,andWhere(r){const o=r(N());return t.conditions.push(I(o,"AND")),n},orWhere(r){const o=r(N());return t.conditions.push(I(o,"OR")),n},path(r){return n.where("path","=",k(r))},skip(r){return t.offset=r,n},where(r,o,c){return n.andWhere(u=>u.where(String(r),o,c)),n},limit(r){return t.limit=r,n},select(...r){return r.length&&t.selectedFields.push(...r),n},order(r,o){return t.orderBy.push(`"${String(r)}" ${o}`),n},async all(){return s(e,i()).then(r=>r||[])},async first(){return s(e,i({limit:1})).then(r=>r[0]||null)},async count(r="*",o=!1){return s(e,i({count:{field:String(r),distinct:o}})).then(c=>c[0].count)}};function i(r={}){let o="SELECT ";if(r!=null&&r.count)o+=`COUNT(${r.count.distinct?"DISTINCT ":""}${r.count.field}) as count`;else{const u=Array.from(new Set(t.selectedFields));o+=u.length>0?u.map(f=>`"${String(f)}"`).join(", "):"*"}o+=` FROM ${q[String(e)]}`,t.conditions.length>0&&(o+=` WHERE ${t.conditions.join(" AND ")}`),t.orderBy.length>0?o+=` ORDER BY ${t.orderBy.join(", ")}`:o+=" ORDER BY stem ASC";const c=(r==null?void 0:r.limit)||t.limit;return c>0&&(t.offset>0?o+=` LIMIT ${c} OFFSET ${t.offset}`:o+=` LIMIT ${c}`),o}return n};function v(e){return`'${String(e).replace(/'/g,"''")}'`}const H=/\d/,Q=["-","_","/","."];function G(e=""){if(!H.test(e))return e!==e.toLowerCase()}function _(e,s){const t=Q,n=[];if(!e||typeof e!="string")return n;let i="",r,o;for(const c of e){const u=t.includes(c);if(u===!0){n.push(i),i="",r=void 0;continue}const f=G(c);if(o===!1){if(r===!1&&f===!0){n.push(i),i=c,r=f;continue}if(r===!0&&f===!1&&i.length>1){const a=i.at(-1);n.push(i.slice(0,Math.max(0,i.length-1))),i=a+c,r=f;continue}}i+=c,r=f,o=u}return n.push(i),n}function V(e){return e?e[0].toUpperCase()+e.slice(1):""}function K(e,s){return e?(Array.isArray(e)?e:_(e)).map(t=>V(s!=null&&s.normalize?t.toLowerCase():t)).join(""):""}function ae(e,s){return e?(Array.isArray(e)?e:_(e)).map(t=>t.toLowerCase()).join("-"):""}function E(e){return s=>(s=s||{},(e||[]).filter(t=>typeof s[t]<"u").reduce((t,n)=>Object.assign(t,{[n]:s[n]}),{}))}async function Y(e,s=[]){var f;const t=e.__params;(f=t==null?void 0:t.orderBy)!=null&&f.length||(e=e.order("stem","ASC"));const n=await e.orWhere(a=>a.where("navigation","<>","false").where("navigation","IS NULL")).select("navigation","stem","path","title","meta",...s||[]).all(),{contents:i,configs:r}=n.reduce((a,d)=>{var p;if(String(d.stem).split("/").pop()===".navigation"){d.title=((p=d.title)==null?void 0:p.toLowerCase())==="navigation"?"":d.title;const g=d.path.split("/").slice(0,-1).join("/")||"/";a.configs[g]={...d,...d.body}}else a.contents.push(d);return a},{configs:{},contents:[]}),o=a=>({...E(["title",...s])(a),...a.meta,...j(a==null?void 0:a.navigation)?a.navigation:{}}),c=a=>({...E(["title",...s])(a),...j(a==null?void 0:a.navigation)?a.navigation:{}}),u=i.reduce((a,d)=>{var O;const p=d.path.substring(1).split("/"),g=d.stem.split("/"),m=!!((O=g[g.length-1])!=null&&O.match(/([1-9]\d*\.)?index/g)),$=l=>({title:l.title,path:l.path,stem:l.stem,children:[],...c(l)}),h=$(d);if(m){const l=r[h.path];if(typeof(l==null?void 0:l.navigation)<"u"&&(l==null?void 0:l.navigation)===!1)return a;if(d.path!=="/"){const y=$(d);h.children.push(y)}l&&Object.assign(h,o(l))}if(p.length===1){const l=a.find(y=>y.path===h.path&&y.page===!1);return m&&l?Object.assign(l,{page:void 0,children:[...h.children||[],...l.children||[]]}):a.push(h),a}const b=p.slice(0,-1).reduce((l,y,x)=>{const T="/"+p.slice(0,x+1).join("/"),S=r[T];if(typeof(S==null?void 0:S.navigation)<"u"&&S.navigation===!1)return[];let w=l.find(C=>C.path===T);if(!w){const C=S?o(S):{};w={...C,title:C.title||z(y),path:T,stem:g.slice(0,x+1).join("/"),children:[],page:!1},l.push(w)}return w.children},a),A=b.find(l=>l.path===h.path&&l.page===!1);return A?Object.assign(A,{...h,page:void 0,children:[...h.children||[],...A.children||[]]}):b.push(h),a},[]);return D(u)}function D(e){var t;const s=e;for(const n of s)(t=n.children)!=null&&t.length?D(n.children):delete n.children;return e}function j(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}const z=e=>e.split(/[\s-]/g).map(K).join(" ");async function J(e,s,t){const{before:n=1,after:i=1,fields:r=[]}={},o=await Y(e,r),c=U(o),u=c.findIndex(d=>d.path===s),f=u===-1?[]:c.slice(u-n,u),a=u===-1?[]:c.slice(u+1,u+i+1);return[...Array.from({length:n}).fill(null).concat(f).slice(f.length),...a.concat(Array.from({length:i}).fill(null)).slice(0,i)]}function U(e){return e.flatMap(t=>{const n=t.children?U(t.children):[];return t.page===!1||n.length&&n.find(i=>i.path===t.path)?n:[{...t,children:void 0},...n]})}function X(e){return{type:"root",children:e.value.map(R)}}function R(e){if(typeof e=="string")return{type:"text",value:e};const[s,t,...n]=e;return{type:"element",tag:s,props:t,children:n.map(R)}}const W=/^h([1-6])$/,Z=e=>W.test(e);async function ee(e,s){const{ignoredTags:t=[],extraFields:n=[]}={};return(await e.where("extension","=","md").select("path","body","description","title",...n||[]).all()).flatMap(r=>te(r,{ignoredTags:t,extraFields:n}))}function te(e,{ignoredTags:s,extraFields:t}){var a,d,p,g;const n=!e.body||((a=e.body)==null?void 0:a.type)==="root"?e.body:X(e.body),i=e.path??"",r=E(t)(e),o=[{...r,id:i,title:e.title||"",titles:[],content:(e.description||"").trim(),level:1}];if(!(n!=null&&n.children))return o;let c=1,u=0;const f=[e.title??""];for(const m of n.children){const $=m.tag||"";if(Z($)){const h=Number(((d=$.match(W))==null?void 0:d[1])??0),b=L(m).trim();h===1?f.splice(0,f.length):h<u?f.splice(h-1,f.length-1):h===u&&f.pop(),o.push({...r,id:`${i}#${(p=m.props)==null?void 0:p.id}`,title:b,titles:[...f],content:"",level:h}),f.push(b),u=h,c+=1}else{const h=L(m,s).trim();if(c===1&&((g=o[c-1])==null?void 0:g.content)===h)continue;o[c-1].content=`${o[c-1].content} ${h}`.trim()}}return o}function L(e,s=[]){var n;let t="";return e.type==="text"&&(t+=e.value||""),s.includes(e.tag??"")?"":((n=e.children)!=null&&n.length&&(t+=e.children.map(i=>L(i,s)).filter(Boolean).join("")),t)}const ne=e=>{var t,n;const s=(n=(t=F())==null?void 0:t.ssrContext)==null?void 0:n.event;return M(e,(i,r)=>re(s,i,r))};function ce(e,s,t){return B(e,n=>J(n,s))}function le(e,s){return B(e,t=>ee(t))}async function re(e,s,t){return ie(s,t)}async function ie(e,s){return await P(()=>import("./C9jFe4fS.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(n=>n.loadDatabaseAdapter(e)).then(n=>n.all(s))}function B(e,s){const t=ne(e),n={where(i,r,o){return t.where(String(i),r,o),n},andWhere(i){return t.andWhere(i),n},orWhere(i){return t.orWhere(i),n},order(i,r){return t.order(String(i),r),n},then(i,r){return s(t).then(i,r)},catch(i){return this.then(void 0,i)},finally(i){return this.then(void 0,void 0).finally(i)},get[Symbol.toStringTag](){return"Promise"}};return n}export{ce as a,le as b,X as d,ae as k,K as p,ne as q};
