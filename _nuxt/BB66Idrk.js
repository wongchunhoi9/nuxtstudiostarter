const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DTSeNtqk.js","./BlR_aFkJ.js","./entry.DOhRGxi2.css","./Cme2URfh.js"])))=>i.map(i=>d[i]);
import{a9 as T,ab as A,_ as C}from"./BlR_aFkJ.js";import{t as I}from"./Cme2URfh.js";const f=(r,s)=>{const t=r._conditions;return t.length>0?`(${t.join(` ${s} `)})`:""},p=r=>{const s=[],t={_conditions:s,where(n,i,e){let o;switch(i.toUpperCase()){case"IN":case"NOT IN":if(Array.isArray(e)){const c=e.map(u=>d(u)).join(", ");o=`"${String(n)}" ${i.toUpperCase()} (${c})`}else throw new TypeError(`Value for ${i} must be an array`);break;case"BETWEEN":case"NOT BETWEEN":if(Array.isArray(e)&&e.length===2)o=`"${String(n)}" ${i.toUpperCase()} ${d(e[0])} AND ${d(e[1])}`;else throw new Error(`Value for ${i} must be an array with two elements`);break;case"IS NULL":case"IS NOT NULL":o=`"${String(n)}" ${i.toUpperCase()}`;break;case"LIKE":case"NOT LIKE":o=`"${String(n)}" ${i.toUpperCase()} ${d(e)}`;break;default:o=`"${String(n)}" ${i} ${d(typeof e=="boolean"?Number(e):e)}`}return s.push(`${o}`),t},andWhere(n){const i=n(p());return s.push(f(i,"AND")),t},orWhere(n){const i=n(p());return s.push(f(i,"OR")),t}};return t},O=(r,s)=>{const t={conditions:[],selectedFields:[],offset:0,limit:0,orderBy:[],count:{field:"",distinct:!1}},n={__params:t,andWhere(e){const o=e(p());return t.conditions.push(f(o,"AND")),n},orWhere(e){const o=e(p());return t.conditions.push(f(o,"OR")),n},path(e){return n.where("path","=",T(e))},skip(e){return t.offset=e,n},where(e,o,c){return n.andWhere(u=>u.where(String(e),o,c)),n},limit(e){return t.limit=e,n},select(...e){return e.length&&t.selectedFields.push(...e),n},order(e,o){return t.orderBy.push(`"${String(e)}" ${o}`),n},async all(){return s(r,i()).then(e=>e||[])},async first(){return s(r,i({limit:1})).then(e=>e[0]||null)},async count(e="*",o=!1){return s(r,i({count:{field:String(e),distinct:o}})).then(c=>c[0].count)}};function i(e={}){let o="SELECT ";if(e!=null&&e.count)o+=`COUNT(${e.count.distinct?"DISTINCT ":""}${e.count.field}) as count`;else{const u=Array.from(new Set(t.selectedFields));o+=u.length>0?u.map(l=>`"${String(l)}"`).join(", "):"*"}o+=` FROM ${I[String(r)]}`,t.conditions.length>0&&(o+=` WHERE ${t.conditions.join(" AND ")}`),t.orderBy.length>0?o+=` ORDER BY ${t.orderBy.join(", ")}`:o+=" ORDER BY stem ASC";const c=(e==null?void 0:e.limit)||t.limit;return c>0&&(t.offset>0?o+=` LIMIT ${c} OFFSET ${t.offset}`:o+=` LIMIT ${c}`),o}return n};function d(r){return`'${String(r).replace(/'/g,"''")}'`}function W(r){return s=>(s=s||{},(r||[]).filter(t=>typeof s[t]<"u").reduce((t,n)=>Object.assign(t,{[n]:s[n]}),{}))}function x(r){return{type:"root",children:r.value.map(E)}}function E(r){if(typeof r=="string")return{type:"text",value:r};const[s,t,...n]=r;return{type:"element",tag:s,props:t,children:n.map(E)}}const b=/^h([1-6])$/,L=r=>b.test(r);async function _(r,s){const{ignoredTags:t=[],extraFields:n=[]}={};return(await r.where("extension","=","md").select("path","body","description","title",...n||[]).all()).flatMap(e=>B(e,{ignoredTags:t,extraFields:n}))}function B(r,{ignoredTags:s,extraFields:t}){var y,$,g,S;const n=!r.body||((y=r.body)==null?void 0:y.type)==="root"?r.body:x(r.body),i=r.path??"",e=W(t)(r),o=[{...e,id:i,title:r.title||"",titles:[],content:(r.description||"").trim(),level:1}];if(!(n!=null&&n.children))return o;let c=1,u=0;const l=[r.title??""];for(const h of n.children){const N=h.tag||"";if(L(N)){const a=Number((($=N.match(b))==null?void 0:$[1])??0),w=m(h).trim();a===1?l.splice(0,l.length):a<u?l.splice(a-1,l.length-1):a===u&&l.pop(),o.push({...e,id:`${i}#${(g=h.props)==null?void 0:g.id}`,title:w,titles:[...l],content:"",level:a}),l.push(w),u=a,c+=1}else{const a=m(h,s).trim();if(c===1&&((S=o[c-1])==null?void 0:S.content)===a)continue;o[c-1].content=`${o[c-1].content} ${a}`.trim()}}return o}function m(r,s=[]){var n;let t="";return r.type==="text"&&(t+=r.value||""),s.includes(r.tag??"")?"":((n=r.children)!=null&&n.length&&(t+=r.children.map(i=>m(i,s)).filter(Boolean).join("")),t)}const D=r=>{var t,n;const s=(n=(t=A())==null?void 0:t.ssrContext)==null?void 0:n.event;return O(r,(i,e)=>q(s,i,e))};function k(r,s){return R(r,t=>_(t))}async function q(r,s,t){return F(s,t)}async function F(r,s){return await C(()=>import("./DTSeNtqk.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(n=>n.loadDatabaseAdapter(r)).then(n=>n.all(s))}function R(r,s){const t=D(r),n={where(i,e,o){return t.where(String(i),e,o),n},andWhere(i){return t.andWhere(i),n},orWhere(i){return t.orWhere(i),n},order(i,e){return t.order(String(i),e),n},then(i,e){return s(t).then(i,e)},catch(i){return this.then(void 0,i)},finally(i){return this.then(void 0,void 0).finally(i)},get[Symbol.toStringTag](){return"Promise"}};return n}export{k as a,x as d,D as q};
